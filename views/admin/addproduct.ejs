<!DOCTYPE HTML>
<html lang="en">


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/page-form-product-2.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:33:32 GMT -->
<head>
    <meta charset="utf-8">
    <title> BOOK-SAW</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/public/spellbook.png">
    <!-- Template CSS -->
    
    <link href="/public/admin-assets/css/main.css" rel="stylesheet" type="text/css" />
    <style>
        .image-item {
            position: relative;
            display: inline-block;
            margin-right: 10px;
        }

        .image-preview {
            position: relative;
        }

        .remove-btn {
            position: absolute;
            top: 100px;
            right: 8px;
            z-index: 1;
        }
    </style>

</head>

<body>
    <div class="screen-overlay"></div>
    <%-include('../partials/adminAside')-%>
    <main class="main-wrap">
        <%-include('../partials/adminHeader')-%>
        <form action="/admin/addProduct" method="post" enctype="multipart/form-data">


            <section class="content-main">
                <div class="row">
                    <div class="col-6">
                        <div class="content-header">
                            <h2 class="content-title">Add New Product</h2>
                            <div>
                                <button class="btn btn-light rounded font-sm mr-5 text-body hover-up">Save to draft</button>
                                <button class="btn btn-md rounded font-sm hover-up" type="submit">Post</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-6">
                        <div class="card mb-4">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <h6>1. General info</h6>
                                    </div>

                                    <div class="col-md-9">
                                        <div class="mb-4">
                                            <label class="form-label">Book Name</label>
                                            <input type="text" name="Bookname" placeholder="Type here" class="form-control">
                                        </div>
                                        <div class="mb-4">
                                            <label class="form-label">Description</label>
                                            <textarea name="Description" placeholder="Type here" class="form-control"></textarea>
                                        </div>
                                        <div class="mb-4">
                                            <label class="form-label">Categories</label>
                                            <select class="form-select" name="Categories">
                                                <% for(let i = 0 ; i < categories.length ; i++) { %>
                                                    <option value="<%=categories[i]._id%>"><%=categories[i].categoryName%></option>
                                                <% } %>
                                                
                                            </select>
                                        </div>
                                        <div class="mb-4">
                                            <label class="form-label">Categories</label>
                                            <select class="form-select" name="subCategories">
                                                <% if(locals.subCat) { %>
                                                    <% for(let i = 0; i < subCat.length; i++) { %>
                                                        <option value="<%= subCat[i]._id %>"><%= subCat[i].subCategoryName %></option>
                                                        
                                                    <% } %>
                                                <% } %>
                                            </select>
                                            
                                        </div>
                                    </div>
                                </div>
                                <hr class="mb-4 mt-0">
                                <div class="row">
                                    <div class="col-md-3">
                                        <h6>2.Price</h6>
                                    </div>
                                    <div class="col-md-9">
                                        <div class="mb-4">
                                            <label class="form-label">Cost in USD</label>
                                            <input type="text"  name="Regularprice"placeholder="$00.0" pattern="^[1-9][0-9]*(.[0-9]+)?$" class="form-control">
                                        </div>
                                    </div> <!-- col.// -->
                                    <div class="col-md-3">
                                        <h6>3. Offer Price</h6>
                                    </div>
                                    <div class="col-md-9">
                                        <div class="mb-4">
                                            <label class="form-label">Cost in USD</label>
                                            <input type="text" name="saleprice" placeholder="$00.0" pattern="^[1-9][0-9]*(.[0-9]+)?$" class="form-control">

                                        </div>
                                    </div> 
                                    <div class="col-md-3">
                                        <h6>4. Stock</h6>
                                    </div>
                                    <div class="col-md-9">
                                        <div class="mb-4">
                                            <label class="form-label">Stock</label>
                                            <input type="text" name="stock"placeholder="0"  pattern="^[1-9][0-9]*(.[0-9]+)?$" class="form-control">
                                        </div>
                                    </div> 
                                </div> 
                                <div class="row">
                                   
                                </div> 
                                <hr class="mb-4 mt-0">
                                <div class="row">
                                    <div class="col-md-3">
                                        <h6>4. Media</h6>
                                    </div>



                    <div class="card-body">
    <div class="input-upload">
        <div id="previewContainer" class="mt-3">
        <ul id="imageList" class="list-unstyled d-flex flex-wrap">
            <!-- Image previews will be added here -->
        </ul>
        </div>
        <div id="previewContainer" class="mt-3"></div>
        <div id="imagePreviewContainer" class="mt-3"></div>                                                    
        <input id="imageInput" class="form-control" name="Images" type="file" accept="image/*" multiple onchange="handleImageSelection(event)">  </div>
    </div>




                                </div> 
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            </section> <!-- content-main end// -->
        </form>
       
        <footer class="main-footer font-xs">
            <div class="row pb-30 pt-15">
                <div class="col-sm-6">
                    <script>
                    document.write(new Date().getFullYear())
                    </script> Â©,BOOK-SAW
                </div>
                <div class="col-sm-6">
                    <div class="text-sm-end">
                        All rights reserved
                    </div>
                </div>
            </div>
        </footer>
    </main>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
 
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const form = document.querySelector("form[action='/admin/addProduct']");
            const regularPriceInput = form.querySelector("input[name='Regularprice']");
            const salePriceInput = form.querySelector("input[name='saleprice']");
    
            form.addEventListener("submit", function(event) {
                const regularPrice = parseFloat(regularPriceInput.value);
                const salePrice = parseFloat(salePriceInput.value);
    
                if (salePrice > regularPrice) {
                    event.preventDefault(); 
                    toastr.error("Regular price must be less than or equal to sale price."); 
                }
            });
        });
    </script>
    
    
    <script>
        document.addEventListener("DOMContentLoaded", function() {
          const form = document.querySelector("form[action='/admin/addProduct']");
          form.addEventListener("submit", function(event) {
            const inputs = form.querySelectorAll("input[type='text'], textarea");
            let isValid = true;

      
            inputs.forEach(function(input) {
              const trimmedValue = input.value.trim();
              if (trimmedValue === "") {
                isValid = false;
                return;
              }
            });
      
            if (!isValid) {
              event.preventDefault();
              toastr.warning("Please fill out all fields.");
            }
          });
        });
      </script>

      
<!-- <script>
    document.addEventListener("DOMContentLoaded", function() {
        const imageInput = document.getElementById("imageInput");
        const previewContainer = document.getElementById("previewContainer");

        imageInput.addEventListener("change", function() {
            previewContainer.innerHTML = '';

            const files = imageInput.files;
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const reader = new FileReader();

                reader.onload = function(e) {
                    const img = document.createElement("img");
                    img.src = e.target.result;
                    img.classList.add("img-thumbnail", "mx-2");
                    previewContainer.appendChild(img);

                    const removeBtn = document.createElement("button");
                    removeBtn.textContent = "Remove";
                    removeBtn.classList.add("btn", "btn-danger", "btn-sm", "mx-2");
                    removeBtn.addEventListener("click", function(event) {
                        event.preventDefault(); // Prevent default form submission
                        const fileName = file.name;
                        // Send request to backend to remove image
                        fetch(`/removseImage?fileName=${fileName}`, {
                            method: 'post'
                        })
                        .then(response => {
                            if (response.ok) {
                                // Remove the image preview from the UI
                                previewContainer.removeChild(img);
                                previewContainer.removeChild(removeBtn);
                            } else {
                                
                                console.error('Failed to remove image from database');
                            }
                        })
                        .catch(error => console.error('Error:', error));
                    });
                    // previewContainer.appendChild(removeBtn); n
                };

                reader.readAsDataURL(file);
            }
        });
    });
</script> -->
<script>
    function validateImages(input) {
        const allowedExtensions = /(\.jpg|\.jpeg|\.png|\.webp)$/i;
    const files = input.files;
    for (let i = 0; i < files.length; i++) {
        const file = files[i];
        if (!allowedExtensions.test(file.name)) {
            toastr.error('Please select only image files (JPEG, JPG, PNG,.webp).');
            input.value = ''; //
            return false; // entry ila
        }
    }
    return true;
}

</script>
<script>
   function handleImageSelection(event) {
    const imagePreviewContainer = document.getElementById('imagePreviewContainer');
    const fileInput = document.getElementById('imageInput');
    
    // Validate the selected images
    if (!validateImages(fileInput)) {
        return; // Stop further processing if validation fails
    }

    imagePreviewContainer.innerHTML = ''; // Clear previous previews

    const files = Array.from(event.target.files);

    for (const file of files) {
        const imagePreview = document.createElement('div');
        imagePreview.classList.add('image-preview', 'position-relative');

        const img = document.createElement('img');
        img.src = URL.createObjectURL(file);
        img.alt = file.name;
        img.classList.add('img-thumbnail', 'mb-2');
        img.style.maxWidth = '100px';

        const fileName = document.createElement('p');
        fileName.textContent = file.name;
        fileName.classList.add('text-muted', 'mb-0');

        const removeButton = document.createElement('button');
        removeButton.classList.add('btn', 'btn-danger', 'btn-sm', 'position-absolute', 'bottom-0', 'start-50', 'translate-middle-x', 'mb-2');
        removeButton.innerHTML = 'Remove';
        removeButton.onclick = () => {
            const fileIndex = Array.from(fileInput.files).indexOf(file);
            if (fileIndex !== -1) {
                const dt = new DataTransfer();
                const files = Array.from(fileInput.files);
                files.splice(fileIndex, 1);
                files.forEach((file) => dt.items.add(file));
                fileInput.files = dt.files;
            }
            imagePreview.remove();
        };

        imagePreview.appendChild(img);
        imagePreview.appendChild(fileName);
        imagePreview.appendChild(removeButton);
        imagePreviewContainer.appendChild(imagePreview);
    }
}

</script>

    <script src="/public/admin-assets/j
    s/vendors/jquery-3.6.0.min.js"></script>
    <script src="/public/admin-assets/js/vendors/bootstrap.bundle.min.js"></script>
    <script src="/public/admin-assets/js/vendors/select2.min.js"></script>
    <script src="/public/admin-assets/js/vendors/perfect-scrollbar.js"></script>
    <script src="/public/admin-assets/js/vendors/jquery.fullscreen.min.js"></script>
    <!-- Main Script -->
    <script src="/public/admin-assets/js/main.js" type="text/javascript"></script>
</body>
</html>